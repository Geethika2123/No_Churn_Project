<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Telecom Churn Prediction</title>
  <!-- Link external CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">
    <h2>Telecom Churn Prediction</h2>

    <form id="churnForm">
      <label>Tenure:</label>
      <input type="number" id="tenure" required>

      <label>Monthly Charges:</label>
      <input type="number" id="monthly" required>

      <label>Total Charges:</label>
      <input type="number" id="total" required>

      <label>Contract One Year (0/1):</label>
      <input type="number" id="contract1" required>

      <label>Contract Two Year (0/1):</label>
      <input type="number" id="contract2" required>

      <label>InternetService Fiber Optic (0/1):</label>
      <input type="number" id="fiber" required>

      <label>InternetService No (0/1):</label>
      <input type="number" id="noservice" required>

      <label>PaymentMethod Electronic Check (0/1):</label>
      <input type="number" id="elec" required>

      <label>PaymentMethod Credit Card (0/1):</label>
      <input type="number" id="credit" required>

      <label>PaymentMethod Mailed Check (0/1):</label>
      <input type="number" id="mailed" required>

      <label>PaymentMethod Bank Transfer (0/1):</label>
      <input type="number" id="bank" required>

      <button type="submit">Predict</button>
    </form>

    <div class="result" id="result"></div>
  </div>

  <script>
    document.getElementById("churnForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      let data = {
        "tenure": parseFloat(document.getElementById("tenure").value),
        "MonthlyCharges": parseFloat(document.getElementById("monthly").value),
        "TotalCharges": parseFloat(document.getElementById("total").value),
        "Contract_One year": parseInt(document.getElementById("contract1").value),
        "Contract_Two year": parseInt(document.getElementById("contract2").value),
        "InternetService_Fiber optic": parseInt(document.getElementById("fiber").value),
        "InternetService_No": parseInt(document.getElementById("noservice").value),
        "PaymentMethod_Electronic check": parseInt(document.getElementById("elec").value),
        "PaymentMethod_Credit card (automatic)": parseInt(document.getElementById("credit").value),
        "PaymentMethod_Mailed check": parseInt(document.getElementById("mailed").value),
        "PaymentMethod_Bank transfer (automatic)": parseInt(document.getElementById("bank").value)
      };

      let response = await fetch("/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      let result = await response.json();
      let resultDiv = document.getElementById("result");

      if (result.churn_flag === 1) {
        resultDiv.innerHTML =
          "Churn Probability: " + result.churn_probability.toFixed(2) +
          "<br><span class='high-risk'>⚠️ High Risk of Churn</span>";
      } else {
        resultDiv.innerHTML =
          "Churn Probability: " + result.churn_probability.toFixed(2) +
          "<br><span class='low-risk'>✅ Low Risk of Churn</span>";
      }
    });
  </script>
</body>
</html>
